<div class="client-container">
  <h2>Gestion des Clients</h2>

  <!-- Section de recherche par CNE -->
  <div class="search-section">
    <label for="searchCne">Rechercher par CNE :</label>
    <input
      type="text"
      id="searchCne"
      [(ngModel)]="searchCne"
      placeholder="Entrer le CNE"
    />
    <button (click)="getClientByCne()">Rechercher</button>
  </div>

  <hr />

  <!-- Formulaire pour ajouter un nouveau client -->
  <div class="form-section">
    <h3>Ajouter un Nouveau Client</h3>
    <form (ngSubmit)="createClient()">
      <div>
        <label for="firstName">Prénom :</label>
        <input type="text" id="firstName" [(ngModel)]="newClient.firstName" name="firstName" required />
      </div>
      <div>
        <label for="lastName">Nom :</label>
        <input type="text" id="lastName" [(ngModel)]="newClient.lastName" name="lastName" required />
      </div>
      <div>
        <label for="email">Email :</label>
        <input type="email" id="email" [(ngModel)]="newClient.email" name="email" required />
      </div>
      <div>
        <label for="phoneNumber">Téléphone :</label>
        <input type="text" id="phoneNumber" [(ngModel)]="newClient.phoneNumber" name="phoneNumber" required />
      </div>
      <div>
        <label for="address">Adresse :</label>
        <input type="text" id="address" [(ngModel)]="newClient.address" name="address" required />
      </div>
      <div>
        <label for="cne">CNE :</label>
        <input type="text" id="cne" [(ngModel)]="newClient.cne" name="cne" required />
      </div>
      <button type="submit">Ajouter</button>
    </form>
  </div>

  <hr />

  <!-- Liste des clients -->
  <div class="clients-section">
    <h3>Liste des Clients</h3>
    <table>
      <thead>
      <tr>
        <th>Prénom</th>
        <th>Nom</th>
        <th>Email</th>
        <th>Téléphone</th>
        <th>Adresse</th>
        <th>CNE</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let client of clients">
        <td>{{ client.firstName }}</td>
        <td>{{ client.lastName }}</td>
        <td>{{ client.email }}</td>
        <td>{{ client.phoneNumber }}</td>
        <td>{{ client.address }}</td>
        <td>{{ client.cne }}</td>
        <td>
          <!-- Vérifiez si idClient n'est pas undefined avant d'appeler les méthodes -->
          <button (click)="updateClient()">Modifier</button>
          <button
            *ngIf="client.idClient !== undefined"
            (click)="deleteClient(client.idClient!)">
            Supprimer
          </button>
        </td>
      </tr>
      </tbody>
    </table>

  </div>

  <hr />

  <!-- Formulaire de mise à jour des clients -->
  <div class="update-section" *ngIf="selectedClient">
    <h3>Modifier le Client</h3>
    <form (ngSubmit)="updateClient()">
      <div>
        <label for="updateFirstName">Prénom :</label>
        <input type="text" id="updateFirstName" [(ngModel)]="selectedClient.firstName" name="updateFirstName" required />
      </div>
      <div>
        <label for="updateLastName">Nom :</label>
        <input type="text" id="updateLastName" [(ngModel)]="selectedClient.lastName" name="updateLastName" required />
      </div>
      <div>
        <label for="updateEmail">Email :</label>
        <input type="email" id="updateEmail" [(ngModel)]="selectedClient.email" name="updateEmail" required />
      </div>
      <div>
        <label for="updatePhoneNumber">Téléphone :</label>
        <input type="text" id="updatePhoneNumber" [(ngModel)]="selectedClient.phoneNumber" name="updatePhoneNumber" required />
      </div>
      <div>
        <label for="updateAddress">Adresse :</label>
        <input type="text" id="updateAddress" [(ngModel)]="selectedClient.address" name="updateAddress" required />
      </div>
      <div>
        <label for="updateCne">CNE :</label>
        <input type="text" id="updateCne" [(ngModel)]="selectedClient.cne" name="updateCne" required />
      </div>
      <button type="submit">Mettre à jour</button>
      <button type="button" (click)="selectedClient = null">Annuler</button>
    </form>
  </div>
</div>
